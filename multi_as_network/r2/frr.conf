frr version 8.1
frr defaults traditional
hostname r2
log syslog informational
no ipv6 forwarding
service integrated-vtysh-config
!
router rip
 network 10.0.1.0/24
 network 10.0.2.0/24
 redistribute connected
 redistribute bgp
exit
!
! Route-maps for BGP traffic engineering
!
route-map PREFER-PEERING permit 10
 set local-preference 200
exit
!
route-map TRANSIT-BACKUP permit 10
 set local-preference 100
exit
!
router bgp 200
 bgp router-id 10.0.3.1
 no bgp ebgp-requires-policy
 neighbor 10.0.3.2 remote-as 100
 neighbor 10.0.3.2 description Transit to Tier1
 neighbor 10.0.9.2 remote-as 300
 neighbor 10.0.9.2 description Peering with ISP2
 !
 address-family ipv4 unicast
  network 10.0.1.0/24
  network 10.0.2.0/24
  network 192.168.1.0/24
  network 192.168.2.0/24
  redistribute rip
  redistribute connected
  ! Apply policies to prefer peering over transit
  neighbor 10.0.9.2 route-map PREFER-PEERING in
  neighbor 10.0.3.2 route-map TRANSIT-BACKUP in
 exit-address-family
exit
!
line vty
!
!
! PIM Configuration
!
interface r2-eth0
 description Link to R1
 ip pim sm
exit
!
interface r2-eth1
 description Link to R3
 ip pim sm
exit
!
interface r2-eth2
 description Link to R4
 ip pim sm
exit
!
interface r2-eth3
 description Peering to R7
 ip pim sm
exit
!
router pim
 rp 10.100.5.1 239.0.0.0/8
exit
!
