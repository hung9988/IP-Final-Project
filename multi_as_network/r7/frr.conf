frr version 8.1
frr defaults traditional
hostname r7
log syslog informational
no ipv6 forwarding
service integrated-vtysh-config
!
router ospf
 ospf router-id 10.0.7.1
 network 10.0.7.0/24 area 0
 network 10.0.8.0/24 area 0
 redistribute bgp
 redistribute connected
exit
!
! Route-maps for BGP traffic engineering
!
route-map PREFER-PEERING permit 10
 set local-preference 200
exit
!
route-map TRANSIT-BACKUP permit 10
 set local-preference 100
exit
!
router bgp 300
 bgp router-id 10.0.6.2
 no bgp ebgp-requires-policy
 neighbor 10.0.6.1 remote-as 100
 neighbor 10.0.6.1 description Transit to Tier1
 neighbor 10.0.9.1 remote-as 200
 neighbor 10.0.9.1 description Peering with ISP1
 !
 address-family ipv4 unicast
  network 10.0.7.0/24
  network 10.0.8.0/24
  network 192.168.3.0/24
  network 192.168.4.0/24
  redistribute ospf
  redistribute connected
  ! Apply policies to prefer peering over transit
  neighbor 10.0.9.1 route-map PREFER-PEERING in
  neighbor 10.0.6.1 route-map TRANSIT-BACKUP in
 exit-address-family
exit
!
line vty
!
!
! PIM Configuration
!
interface r7-eth0
 description Link to R8
 ip pim sm
exit
!
interface r7-eth1
 description Link to R9
 ip pim sm
exit
!
interface r7-eth2
 description Link to R6
 ip pim sm
exit
!
interface r7-eth3
 description Peering to R2
 ip pim sm
exit
!
router pim
 rp 10.100.5.1 239.0.0.0/8
exit
!
